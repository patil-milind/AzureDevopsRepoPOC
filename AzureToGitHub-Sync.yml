trigger:
  branches:
    include:
      - '*'
pr:
  branches:
    include:
      - '*'

jobs:
  - job: SyncToGitHub
    displayName: "Sync Azure DevOps Repo to GitHub"
    pool:
      vmImage: 'ubuntu-latest'

    steps:
      - checkout: self

      - script: |
          
          echo "Setting up Git configuration..."
          git checkout dev
          echo "Print directory Azure"
          ls -al
          
          git config --global user.name "patil-milind"
          git config --global user.email "milind.patl02@gmail.com"

          echo "Adding GitHub remote..."
          git remote add github "https://$GITHUB_TOKEN@github.com/patil-milind/AzureDevopsRepoPOC.git"
         
          echo "Fetching the latest from GitHub..."
          git fetch github
          echo "Checking for differences..."
          git diff --exit-code github/dev
          echo "Pushing branches to GitHub...1"
          git push github dev
 
          echo "Pushing tags to GitHub..."
          git push --tags --force github
        displayName: "Sync changes to GitHub"
        env:
          GITHUB_TOKEN: $(GitPAT)
